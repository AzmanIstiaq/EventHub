<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Admin - Event Details</title>
    <link rel="stylesheet" th:href="@{/style.css}">
  <style>
    body { margin: 20px; background-color: #f8f9fa; }
    .admin-header { background-color: #dc3545; color: white; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
    .card { background: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .btn { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; }
    .btn-primary { background-color: #007bff; color: white; }
    .btn-danger { background-color: #dc3545; color: white; }
    .btn-success { background-color: #28a745; color: white; }
    .btn-secondary { background-color: #6c757d; color: white; }
    .btn:hover { opacity: 0.8; }
    .event-info { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
    .info-item { margin-bottom: 15px; }
    .info-label { font-weight: bold; color: #495057; margin-bottom: 5px; }
    .info-value { color: #212529; }
    .status { padding: 6px 12px; border-radius: 15px; font-size: 0.9em; font-weight: bold; }
    .status-upcoming { background-color: #d4edda; color: #155724; }
    .status-past { background-color: #f8d7da; color: #721c24; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background-color: #f8f9fa; }
    tr:nth-child(even) { background-color: #f8f9fa; }
  </style>
</head>
<body>
<div th:replace="fragments/navbar-common"></div>

<div class="admin-header">
  <h1>📋 Event Details - Admin View</h1>
  <p>Detailed information and management options</p>
</div>

<!-- Back Navigation -->
<div style="margin-bottom: 20px;">
  <a href="/admin/events" class="btn btn-secondary">← Back to All Events</a>
  <a href="/admin/dashboard" class="btn btn-primary">📊 Dashboard</a>
</div>

<!-- Event Information -->
<div class="card">
  <h2 th:text="${event.title}">Event Title</h2>

  <div class="event-info">
    <div>
      <div class="info-item">
        <div class="info-label">Description</div>
        <div class="info-value" th:text="${event.description}">Event description here</div>
      </div>

      <div class="info-item">
        <div class="info-label">Location</div>
        <div class="info-value" th:text="${event.location}">Event location</div>
      </div>

      <div class="info-item">
        <div class="info-label">Date & Time</div>
        <div class="info-value" th:text="${#temporals.format(event.dateTime, 'EEEE, MMMM dd, yyyy HH:mm')}">
          Monday, January 01, 2024 10:00
        </div>
      </div>
    </div>

    <div>
      <div class="info-item">
        <div class="info-label">Organizer</div>
        <div class="info-value">
          <strong th:text="${event.organiser.name}">Organizer Name</strong><br>
          <small th:text="${event.organiser.email}">organizer@email.com</small>
        </div>
      </div>

      <div class="info-item">
        <div class="info-label">Status</div>
        <div>
                        <span th:if="${event.dateTime.isAfter(#temporals.createNow())}"
                              class="status status-upcoming">🟢 Upcoming</span>
          <span th:if="${event.dateTime.isBefore(#temporals.createNow())}"
                class="status status-past">🔴 Past Event</span>
        </div>
      </div>

      <div class="info-item">
        <div class="info-label">Total Registrations</div>
        <div class="info-value">
          <strong th:text="${registrationCount}">0</strong> registered participants
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Actions -->
  <div style="border-top: 2px solid #dee2e6; padding-top: 20px; margin-top: 20px;">
    <h4>🔧 Admin Actions</h4>
    <a th:href="@{'/organiser/' + ${event.organiser.userId} + '/events/' + ${event.eventId} + '/edit'}"
       class="btn btn-primary">✏️ Edit Event</a>

    <form th:action="@{'/admin/events/' + ${event.eventId} + '/delete'}"
          method="post"
          style="display: inline;"
          onsubmit="return confirm('Are you sure you want to delete this event? This will also cancel all registrations. This action cannot be undone.');">
      <button type="submit" class="btn btn-danger">🗑️ Delete Event</button>
    </form>

    <a th:href="@{'/registrations/event/' + ${event.eventId}}"
       class="btn btn-success">📋 View Registrations</a>
  </div>
</div>

<!-- Registration Details -->
<div class="card" th:if="${!registrations.isEmpty()}">
  <h3>👥 Event Registrations</h3>
  <table>
    <thead>
    <tr>
      <th>Registration ID</th>
      <th>Participant Name</th>
      <th>Email</th>
      <th>Registration Date</th>
<!--      <th>Status</th>-->
    </tr>
    </thead>
    <tbody>
    <tr th:each="registration : ${registrations}">
      <td th:text="${registration.registrationIdId}">1</td>
      <td th:text="${registration.user.name}">User Name</td>
      <td th:text="${registration.user.email}">user@email.com</td>
      <td th:text="${registration.registrationDate != null ? #temporals.format(registration.registrationDate, 'yyyy-MM-dd HH:mm') : 'N/A'}">
        2024-01-01 10:00
      </td>
<!--      <td th:text="${registration.status != null ? registration.status : 'CONFIRMED'}">CONFIRMED</td>-->
    </tr>
    </tbody>
  </table>
</div>

<div class="card" th:if="${registrations.isEmpty()}">
  <h3>👥 Event Registrations</h3>
  <div style="text-align: center; padding: 40px; color: #6c757d;">
    <h4>📝 No Registrations Yet</h4>
    <p>No one has registered for this event yet.</p>
  </div>
</div>

<!-- Footer -->
<div style="margin-top: 40px; padding: 20px; background-color: white; border-radius: 5px; text-align: center; color: #6c757d;">
  <p><strong>Admin Event Management</strong> | Use administrative privileges responsibly</p>
</div>
</body>
</html>