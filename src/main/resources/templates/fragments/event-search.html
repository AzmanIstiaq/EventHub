<div th:fragment="event-search(currentUser, searchResults)">
 <h2>Search Events</h2>
 <form th:if="${currentUser != null}" th:action="@{/events/search}" method="get">
  <!-- Text search -->
  <input type="text" name="query" placeholder="Search by title, location, or keyword" />
 
  <!-- Date range -->
  <label>From:</label>
  <input type="date" name="startDate" th:value="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}"
   min="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}" />
  <label>To:</label>
  <input type="date" name="endDate" min="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}" />
 
  <!-- Category dropdown -->
  <select name="categoryId">
   <option value="">All Categories</option>
   <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.category}"></option>
  </select>
 
  <!-- Include userId if logged in -->
  <input th:if="${currentUser}" type="hidden" name="userId" th:value="${currentUser.getUserId()}" />
 
  <button type="submit" class="btn btn-grey">Search</button>
  <!-- Clear Filters Button -->
  <a th:if="${currentUser != null}" th:href="@{/events/search(userId=${currentUser.getUserId()})}" class="btn btn-grey"
   style="margin-left:0.5rem;">
   Clear All Filters
  </a>
 
  <a th:unless="${currentUser != null}" th:href="@{/events/search}" class="btn btn-grey" style="margin-left:0.5rem;">
   Clear All Filters
  </a>
 </form>
 <form th:unless="${currentUser != null}" th:action="@{/events/public/search}" method="get">
  <!-- Text search -->
  <input type="text" name="query" placeholder="Search by title, location, or keyword" />
 
  <!-- Date range -->
  <label>From:</label>
  <input type="date" name="startDate" th:value="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}"
   min="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}" />
  <label>To:</label>
  <input type="date" name="endDate" min="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}" />
 
  <!-- Category dropdown -->
  <select name="categoryId">
   <option value="">All Categories</option>
   <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.category}"></option>
  </select>
 
  <!-- Include userId if logged in -->
  <input th:if="${currentUser}" type="hidden" name="userId" th:value="${currentUser.getUserId()}" />
 
  <button type="submit" class="btn btn-grey">Search</button>
  <!-- Clear Filters Button -->
  <a th:unless="${currentUser != null}" th:href="@{/events/public/search}" class="btn btn-grey"
   style="margin-left:0.5rem;">
   Clear All Filters
  </a>
 </form>
 
 
 
 <!-- Results -->
 <div th:if="${searchResults != null}">
  <h3 th:if="${#lists.isEmpty(searchResults)}" class="empty-message">No events found.</h3>
  <div class="events-grid" th:unless="${#lists.isEmpty(searchResults)}">
   <div th:each="event : ${searchResults}">
    <div th:replace="~{fragments/event-card :: event-card(${event}, ${currentUser}, ${futureEvents})}"></div>
   </div>
  </div>
 </div>
</div>